<div class="combat-weapon-wrapper {{ifThen isSub 'subweapon' ''}} col item" data-item-id="{{item._id}}" data-subweapon="{{isSub}}">
    <div class="combat-weapon row-section">
        <div class="combat-item-image col zerofive image  {{item.system.damageToolTip.css}}" data-tooltip="{{item.system.damageToolTip.msg}}" style="background-image: url('{{item.img}}')">
            {{#if (and item.structureMax (not isSub))}}
            <div class="item-structure" style="--a: {{item.structureMax}}; --b: {{item.structureCurrent}}">
                <div class="inner"></div>
            </div>
            {{/if}}
        </div>
        <div class="combat-item-name three col">
            <a class="item-edit">{{item.name}}</a>
        </div>

        <div class="combat-item-skill col five center small onlyMultiColumn">
            {{localize item.system.combatskill.value}}
        </div>

        <div class="combat-item-attack col ten center item" data-item-id="{{item._id}}" data-mod="attack">
            <a data-mode="attack" class="ch-rollCombat d20 die-attack">{{item.attack}}</a>
        </div>
        <div class="combat-item-damage col ten center">
            <a data-mode="damage" class="ch-rollCombat d6 die-damage">{{item.damagedie}}</a><span data-tooltip="{{localize 'damageOverThreshold'}}{{item.damageBonusDescription}}">{{item.damageAdd}}</span>
        </div>

        <div class="combat-item-range col five center max20">
            {{#if (ne item.system.ammunitiongroup.value "-")}}
            <div class="row-section">

                <div class="magazinContainer">
                    {{#if item.ammoMax}}
                    <div class="item-structure" style="--a: {{item.ammoMax}}; --b: {{item.ammoCurrent}}">
                        <div class="inner"></div>
                    </div>
                    {{/if}}
                </div>
                {{#if item.ammo}}
                <select name="currentAmmo-{{item._id}}" class="ammo-selector" data-item-id="{{item._id}}" data-dtype="String">
                    {{selectOptions item.ammo selected=item.system.currentAmmo.value blank="-" valueAttr="_id" labelAttr="label"}}
                </select>
                {{else}}
                <select name="currentAmmo-{{item._id}}" class="ammo-selector" data-item-id="{{item._id}}" data-dtype="String">
                    <option>-</option>  
                </select>
                {{/if}}
                {{#if (ne item.LZ 0)}}
                <a class="loadWeapon" data-tooltip="{{item.title}}">
                    <div class="progress blue">
                        <span class="progress-left" style="--transformLeft:{{item.transformLeft}}">
                            <span class="progress-bar"></span>
                        </span>
                        <span class="progress-right" style="--transformRight:{{item.transformRight}}">
                            <span class="progress-bar"></span>
                        </span>
                        <div class="progress-value">{{item.progress}}</div>
                    </div>
                </a> {{/if}}
            </div>
            {{else}}
            <div class="no-ammo">
                - {{#if (ne item.LZ 0)}}
                <a class="loadWeapon" data-tooltip="{{item.title}}">
                    <div class="progress blue">
                        <span class="progress-left" style="--transformLeft:{{item.transformLeft}}">
                            <span class="progress-bar"></span>
                        </span>
                        <span class="progress-right" style="--transformRight:{{item.transformRight}}">
                            <span class="progress-bar"></span>
                        </span>
                        <div class="progress-value">{{item.progress}}</div>
                    </div>
                </a> {{/if}}
            </div>
            {{/if}}
        </div>
        <div class="col zerofive very-small center onlyMultiColumn">
            <a class="item-dropdown" data-tooltip="SHEET.Dropdown"><i class="fas fa-chevron-down"></i></a> {{#if item.ammoMax}}
            <a class="item-swapMag" data-tooltip="SHEET.swapMag"><i class="fas fa-retweet"></i></a> {{/if}}
        </div>
    </div>
    <div class="row-section lineheight expandDetails {{item.detailed}}">
        <div class="col">
            <ul>
                <li><b>{{localize "reach"}}</b>: {{item.calculatedRange}}</li>
                <li><b>{{localize "reloadTime"}}</b>: {{item.LZ}} ({{item.system.reloadTime.progress}})</li>
            </ul>
        </div>
    </div>
</div>
{{#each item.subweapons as |sub key|}}
    {{> systems/dsa5/templates/actors/parts/combat_rangeweapon.hbs item=sub isSub=key}}
{{/each}}