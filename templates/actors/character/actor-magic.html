<div class="groupbox">
    <div class="row-section wrap inverseRowtable">
        <div class="col">
            <div class="row-section skills table-title">
                <div class="col four">
                    {{localize "spells"}}
                </div>
                <div class="col four center">{{localize "probe"}}</div>
                <div class="col ten center" data-tooltip="Fw">{{localize "CHARAbbrev.FW"}}</div>
                <div class="col ten center" data-tooltip="AsPCost">{{localize "cost"}}</div>
                <div class="col ten center">{{localize "CHARAbbrev.castingTime"}}</div>
                <div class="col ten center">{{localize "reach"}}</div>
                <div class="col ten center">
                    <a class="item-create very-small" data-tooltip="SHEET.addItem" item-section="spell" data-type="spell"><i class="fas fa-plus"></i></a>
                </div>
            </div>
        </div>
        {{#each prepare.magic.spell as |item i|}}
        <div class="col spells item" data-item-id="{{item._id}}">
            <div class="row-section skills lineheight">
                <div class="col four">
                    <a class="item-edit">{{item.name}}</a> {{#if ../prepare.canAdvance}}
                    <a class="advance refund-item"><i data-tooltip="{{item.refund}}" class="fas fa-minus"></i></a>
                    <a class="advance advance-item"><i data-tooltip="{{item.cost}}" class="fas fa-plus"></i></a>{{/if}}
                </div>
                <div class="col four center">
                    <a class="spell-select">
                        <span class="d20 diet-{{item.system.characteristic1.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic1.value)}}</span>
                        <span class="d20 diet-{{item.system.characteristic2.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic2.value)}}</span>
                        <span class="d20 diet-{{item.system.characteristic3.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic3.value)}}</span>
                    </a>
                </div>
                <div class="col ten center">
                    <input class="skill-advances" type="text" data-dtype="Number" value="{{item.system.talentValue.value}}" />
                </div>
                <div class="col ten center">
                    {{item.system.AsPCost.value}}
                </div>
                <div class="col ten center">
                    {{item.system.castingTime.value}} {{#if (gt item.LZ 1)}}
                    <a class="chargeSpell" data-tooltip="{{item.title}}">
                        <div class="progress blue">
                            <span class="progress-left" style="--transformLeft:{{item.transformLeft}}">
                                    <span class="progress-bar"></span>
                            </span>
                            <span class="progress-right" style="--transformRight:{{item.transformRight}}">
                                    <span class="progress-bar"></span>
                            </span>
                            <div class="progress-value">{{item.progress}}</div>
                        </div>
                    </a> {{/if}}
                </div>
                <div class="col ten center">
                    {{item.system.range.value}}
                </div>

                <div class="col ten very-small center">
                    <a class="item-post" data-tooltip="SHEET.PostItem"><i class="fas fa-comment"></i></a>
                    <a class="item-dropdown" data-tooltip="SHEET.Dropdown"><i class="fas fa-chevron-down"></i></a>
                    <a class="item-control item-delete" data-tooltip="SHEET.DeleteItem"><i class="fas fa-trash"></i></a> {{#if item.extensions}}
                    <i class="fas fa-angle-double-up" data-tooltip="{{item.extensions}}"></i> {{/if}}
                </div>
            </div>
            <div class="row-section lineheight expandDetails {{item.detailed}}">
                <div class="col">
                    <ul>
                        <li><b>{{localize "duration"}}</b>: {{item.system.duration.value}}</li>
                        <li><b>{{localize "cost"}}</b>: {{item.system.AsPCostDetail.value}}</li>
                    </ul>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
</div>
<div class="groupbox">
    <div class="row-section wrap inverseRowtable">
        <div class="col">
            <div class="row-section skills table-title">
                <div class="col four">
                    {{localize "rituals"}}
                </div>
                <div class="col four center">{{localize "probe"}}</div>
                <div class="col ten center" data-tooltip="Fw">{{localize "CHARAbbrev.FW"}}</div>
                <div class="col ten center" data-tooltip="AsPCost">{{localize "cost"}}</div>
                <div class="col ten center">{{localize "CHARAbbrev.castingTime"}}</div>
                <div class="col ten center">{{localize "reach"}}</div>
                <div class="col ten center">
                    <a class="item-create very-small" data-tooltip="SHEET.addItem" item-section="ritual" data-type="ritual"><i class="fas fa-plus"></i></a>

                </div>
            </div>
        </div>
        {{#each prepare.magic.ritual as |item i|}}
        <div class="col spells item" data-item-id="{{item._id}}">
            <div class="row-section skills lineheight">
                <div class="col four">
                    <a class="item-edit">{{item.name}}</a> {{#if ../prepare.canAdvance}}
                    <a class="advance refund-item"><i data-tooltip="{{item.refund}}" class="fas fa-minus"></i></a>
                    <a class="advance advance-item"><i data-tooltip="{{item.cost}}" class="fas fa-plus"></i></a>{{/if}}
                </div>
                <div class="col four center">
                    <a class="spell-select">
                        <span class="d20 diet-{{item.system.characteristic1.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic1.value)}}</span>
                        <span class="d20 diet-{{item.system.characteristic2.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic2.value)}}</span>
                        <span class="d20 diet-{{item.system.characteristic3.value}}">{{localize (concatUp "CHARAbbrev." item.system.characteristic3.value)}}</span>
                    </a>
                </div>
                <div class="col ten center">
                    <input class="skill-advances" type="text" data-dtype="Number" value="{{item.system.talentValue.value}}" />
                </div>
                <div class="col ten center">
                    {{item.system.AsPCost.value}}
                </div>
                <div class="col ten center">
                    {{item.system.castingTime.value}}
                </div>
                <div class="col ten center">
                    {{item.system.range.value}}
                </div>

                <div class="col ten very-small center">
                    <a class="item-post" data-tooltip="SHEET.PostItem"><i class="fas fa-comment"></i></a>
                    <a class="item-dropdown" data-tooltip="SHEET.Dropdown"><i class="fas fa-chevron-down"></i></a>
                    <a class="item-control item-delete" data-tooltip="SHEET.DeleteItem"><i class="fas fa-trash"></i></a> {{#if item.extensions}}
                    <i class="fas fa-angle-double-up" data-tooltip="{{item.extensions}}"></i> {{/if}}
                </div>
            </div>
            <div class="row-section lineheight expandDetails {{item.detailed}}">
                <div class="col">
                    <ul>
                        <li><b>{{localize "duration"}}</b>: {{item.system.duration.value}}</li>
                        <li><b>{{localize "cost"}}</b>: {{item.system.AsPCostDetail.value}}</li>
                    </ul>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
</div>

<div class="groupbox">
    <div class="row-section wrap inverseRowtable">
        <div class="col">
            <div class="row-section skills table-title">
                <div class="col third">{{localize "traditionArtifact"}}</div>
                <div class="col third center">{{localize "Category"}}</div>
                <div class="col third center">{{localize "volume"}}</div>
                <div class="col ten center">
                    <a class="selectTraditionartifact very-small" data-tooltip="SHEET.selectTraditionartifact"><i class="fas fa-plus"></i></a>
                </div>
            </div>
        </div>
        {{#each prepare.traditionArtifacts as |item i|}}
        <div class="col spells item" data-item-id="{{item._id}}">
            <div class="row-section skills lineheight">
                <div class="col third"><a class="item-edit">{{item.name}}</a></div>
                <div class="col third center">{{item.system.artifact}}</div>
                <div class="col third center">{{item.volumeFinal}} / {{item.volume}}</div>
                <div class="col ten very-small center">
                    <a class="tradition-delete" data-tooltip="SHEET.DeleteItem"><i class="fas fa-trash"></i></a>
                </div>
            </div>
            <div class="row-section expandDetails shown">
                <div class="row-section wrap cards col">
                {{#each item.abilities as |ab i|}}
                <div class="item" data-item-id="{{ab._id}}">
                    {{#if ab.OnUseEffect}}<a data-tooltip="SHEET.onUseEffect" class="onUseItem"><i class="fas fa-dice-six"></i></a>{{/if}}<a class="item-edit">{{ab.name}}{{roman ab.system.step.value ab.system.maxRank.value}}</a>
                </div>
                {{/each}}
                </div>
            </div>
        </div>
        {{/each}}
    </div>
</div>

<div class="groupbox">
    <div class="row-section">
        <div class="col header-label lineheight">
            <b>{{localize "magicspecialtalents"}}</b>
        </div>
    </div>
    <div class="row-section wrap cards">
        {{#each prepare.specAbs.magical as |item i|}}
        <div class="item" data-item-id="{{item._id}}">
            {{#if item.OnUseEffect}}<a data-tooltip="SHEET.onUseEffect" class="onUseItem"><i class="fas fa-dice-six"></i></a>{{/if}}<a class="item-edit">{{item.name}}{{roman item.system.step.value item.system.maxRank.value}}</a>
        </div>
        {{/each}}
    </div>
</div>

<div class="row-section wrap reverseFlex">
    <div class="col morph">
        <div class="groupbox">
            <div class="row-section">
                <div class="col header-label lineheight">
                    <b>{{localize "magictricks"}}</b>
                </div>
            </div>
            <div class="row-section wrap cards">
                {{#each prepare.magic.magictrick as |item i|}}
                <div class="item" data-item-id="{{item._id}}">
                    <a class="item-edit">{{item.name}}</a>
                </div>
                {{/each}}
            </div>

        </div>
        {{> systems/dsa5/templates/actors/parts/magicalSigns.html}}
    </div>
    <div class="col morph">

        <div class="groupbox">
            <div class="row-section lineheight">
                <div class="col fourty center">
                    {{localize "tradition"}}
                </div>
                <div class="col sixty">
                    <input type="text" name="system.tradition.magical" data-dtype="String" value="{{actor.system.tradition.magical}}">
                </div>
            </div>
            <div class="row-section lineheight">
                <div class="col fourty center">
                    {{localize "guidevalue"}}
                </div>
                <div class="col sixty">
                    <div class="form-group">
                        <select name="system.guidevalue.magical" data-dtype="String">
                            {{selectOptions prepare.guidevalues selected=actor.system.guidevalue.magical localize=true}}
                        </select>
                    </div>
                </div>
            </div>
            <div class="row-section lineheight">
                <div class="col fourty center">
                    {{localize "feature"}}
                </div>
                <div class="col sixty">
                    <input type="text" name="system.feature.magical" data-dtype="String" value="{{actor.system.feature.magical}}">
                </div>
            </div>
            <div class="row-section lineheight">
                <div class="col fourty center">
                    {{localize "energyfactor"}}
                </div>
                <div class="col sixty">
                    <input type="text" name="system.energyfactor.magical" data-dtype="number" value="{{actor.system.energyfactor.magical}}" />
                </div>
            </div>
        </div>
    </div>
    
</div>